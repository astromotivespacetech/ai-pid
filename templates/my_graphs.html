<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Saved Graphs - AI PI&D Tool</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <h1>My Saved PI&D Graphs</h1>
    {% if user %}
    <div style="padding:8px;margin-bottom:12px;border:1px solid #ddd;background:#f8fff8">
        Signed in as <strong>{{ user.display_name or user.email or user.username }}</strong>
        <span style="margin-left:8px"><a href="/logout">Logout</a></span>
        <span style="margin-left:8px"><a href="/">‚Üê Back to Generator</a></span>
    </div>
    {% endif %}

    <h2>Your Saved Graphs</h2>
    
    {% if graphs %}
    <table style="width:100%;border-collapse:collapse;margin-top:20px">
        <thead>
            <tr style="background:#f0f0f0;border-bottom:2px solid #ddd">
                <th style="padding:10px;text-align:left">Created</th>
                <th style="padding:10px;text-align:left">Description</th>
                <th style="padding:10px;text-align:left">Nodes</th>
                <th style="padding:10px;text-align:left">Edges</th>
                <th style="padding:10px;text-align:left">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for graph in graphs %}
            <tr style="border-bottom:1px solid #eee">
                <td style="padding:10px">{{ graph.created_at[:10] }}</td>
                <td style="padding:10px">{{ graph.instruction[:50] }}{% if graph.instruction|length > 50 %}...{% endif %}</td>
                <td style="padding:10px">{{ graph.nodes|length if graph.nodes else 0 }}</td>
                <td style="padding:10px">{{ graph.edges|length if graph.edges else 0 }}</td>
                <td style="padding:10px">
                    <a href="/load-graph/{{ graph.id }}" style="margin-right:10px">Load</a>
                    <a href="/download-graph/{{ graph.id }}" style="margin-right:10px">Download</a>
                    <form action="/delete-graph/{{ graph.id }}" method="post" style="display:inline" onsubmit="return confirm('Are you sure you want to delete this graph?')">
                        <button type="submit" style="background:none;border:none;color:#c00;cursor:pointer;text-decoration:underline;padding:0">Delete</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div style="padding:20px;margin-top:20px;border:1px solid #ddd;background:#f9f9f9">
        <p>You haven't saved any graphs yet. <a href="/">Create your first PI&D graph</a>.</p>
    </div>
    {% endif %}
</body>
</html>
